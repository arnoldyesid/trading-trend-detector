version: "3"

services:
  admin_users:
    build: ./build/admin_users
    command: python3 manage.py runserver 0.0.0.0:8000
    volumes:
      - ../admin_users/:/usr/app/
    ports:
      - "8000:8000"
    depends_on: [mysqldb]
    links: 
      - mysqldb

  users_view:
    build: ./build/users_view
    command: nodemon app.js
    volumes:
      - ../users-view/:/app/
    ports:
      - "3000:3000"
  
  mysqldb:
    image: mysql
    ports:
    - 13306:3306
    environment: 
      - MYSQL_ROOT_PASSWORD=admin
      - MYSQL_ALLOW_EMPTY_PASSWORD=1
      - MYSQL_DATABASE=admin
      - MYSQL_USER=admin
      - MYSQL_PASSWORD=admin

    volumes:
    - ../persistence/mysql/:/var/lib/mysql-files
    - ../persistence/mysql_config/:/etc/mysql
